<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Macros</title>
</head>
<body>
    {% macro render_profile(user) %}
    <h1>{{ _('User') }}: {{ user.username }}</h1>
    {% if user.about_me %}
        <p>{{ user.about_me }}</p>
    {% endif %}
    {% if user.last_seen %}
        <p>{{ _('Last seen on') }}: {{ moment(user.last_seen).format('LLL') }}</p>
    {% endif %}
    <p>{{ _('%(count)d followers', count=user.followers_count()) }},
       {{ _('%(count)d following', count=user.following_count()) }}</p>
    {% if user == current_user %}
        <p><a href="{{ url_for('main.edit_profile') }}">{{ _('Edit your profile') }}</a></p>
        {% if not current_user.get_task_in_progress('export_posts') %}
        <p><a href="{{ url_for('main.export_posts') }}">{{ _('Export your posts') }}</a></p>
        {% endif %}
    {% elif not current_user.is_following(user) %}
        {{ render_follow_form(user, 'Follow') }}
    {% else %}
        {{ render_follow_form(user, 'Unfollow') }}
    {% endif %}
    {% if user != current_user %}
        <p><a href="{{ url_for('main.send_message', recipient=user.username) }}">{{ _('Send private message') }}</a></p>
    {% endif %}
    {% endmacro %}

    {% macro render_follow_form(user, action) %}
    <p>
        <form action="{{ url_for('main.' + action.lower(), username=user.username) }}" method="post">
            {{ form.hidden_tag() }}
            {{ form.submit(value=_(action), class_='btn btn-primary') }}
        </form>
    </p>
    {% endmacro %}
</body>
</html>
